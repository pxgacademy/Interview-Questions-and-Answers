# 7. Environment variables

Next.js-এ **এনভায়রনমেন্ট ভ্যারিয়েবলস** (Environment Variables) হল একটি গুরুত্বপূর্ণ ফিচার, যা অ্যাপ্লিকেশনের কনফিগারেশন এবং সংবেদনশীল তথ্য (যেমন API কী, ডাটাবেস URL) পরিচালনার জন্য ব্যবহৃত হয়। এটি ডেভেলপমেন্ট, টেস্টিং, এবং প্রোডাকশন পরিবেশে বিভিন্ন কনফিগারেশন সেটিংস সংরক্ষণের জন্য একটি নিরাপদ এবং নমনীয় উপায় প্রদান করে। এনভায়রনমেন্ট ভ্যারিয়েবলস ব্যবহার করে আপনি কোডে হার্ডকোডেড মান এড়িয়ে অ্যাপ্লিকেশনের সিকিউরিটি এবং পোর্টাবিলিটি উন্নত করতে পারেন। সিনিয়র ডেভেলপারদের জন্য এই কনসেপ্টটি বোঝা এবং সঠিকভাবে প্রয়োগ করা অ্যাপ্লিকেশনের সিকিউরিটি, স্কেলেবিলিটি, এবং রক্ষণাবেক্ষণের জন্য অত্যন্ত গুরুত্বপূর্ণ। এই বিস্তারিত আলোচনায় আমরা এনভায়রনমেন্ট ভ্যারিয়েবলসের কাজ, ব্যবহার, এবং সিনিয়র ডেভেলপারদের জন্য গুরুত্বপূর্ণ টিপস নিয়ে আলোচনা করব।

---

## এনভায়রনমেন্ট ভ্যারিয়েবলস কী?

এনভায়রনমেন্ট ভ্যারিয়েবলস হল কী-ভ্যালু পেয়ার, যা অ্যাপ্লিকেশনের রানটাইম পরিবেশে সংরক্ষিত থাকে এবং কোড থেকে অ্যাক্সেস করা যায়। এগুলো সাধারণত সংবেদনশীল তথ্য (যেমন API কী, ডাটাবেস ক্রেডেনশিয়াল) বা পরিবেশ-নির্দিষ্ট কনফিগারেশন (যেমন ডেভেলপমেন্ট বা প্রোডাকশন URL) সংরক্ষণের জন্য ব্যবহৃত হয়। Next.js-এ এনভায়রনমেন্ট ভ্যারিয়েবলস `.env` ফাইলের মাধ্যমে ডিফাইন করা হয় এবং `process.env` অবজেক্টের মাধ্যমে অ্যাক্সেস করা যায়।

Next.js দুই ধরনের এনভায়রনমেন্ট ভ্যারিয়েবল সমর্থন করে:
1. **সার্ভার-সাইড এনভায়রনমেন্ট ভ্যারিয়েবলস**: শুধুমাত্র সার্ভার-সাইড কোডে অ্যাক্সেসযোগ্য।
2. **ক্লায়েন্ট-সাইড এনভায়রনমেন্ট ভ্যারিয়েবলস**: ক্লায়েন্ট-সাইডে অ্যাক্সেসযোগ্য, তবে এর জন্য `NEXT_PUBLIC_` প্রিফিক্স ব্যবহার করতে হয়।

---

## এনভায়রনমেন্ট ভ্যারিয়েবলস কিভাবে কাজ করে?

Next.js-এ এনভায়রনমেন্ট ভ্যারিয়েবলস `.env` ফাইলে ডিফাইন করা হয় এবং Node.js-এর `process.env` অবজেক্টের মাধ্যমে অ্যাক্সেস করা যায়। Next.js স্বয়ংক্রিয়ভাবে `.env` ফাইল লোড করে, তবে কিছু নির্দিষ্ট নিয়ম মেনে চলতে হয়।

### `.env` ফাইলের প্রকার:
1. **`.env`**: সব পরিবেশের জন্য ডিফল্ট ভ্যারিয়েবল।
2. **`.env.local`**: লোকাল ডেভেলপমেন্টের জন্য নির্দিষ্ট ভ্যারিয়েবল, যা `.env` ফাইলকে ওভাররাইড করে।
3. **`.env.development`**: ডেভেলপমেন্ট পরিবেশের জন্য।
4. **`.env.production`**: প্রোডাকশন পরিবেশের জন্য।

### `.env` ফাইলের উদাহরণ:

```env
# .env.local
DB_HOST=localhost
DB_USER=myuser
DB_PASS=mypassword

# ক্লায়েন্ট-সাইড ভ্যারিয়েবল
NEXT_PUBLIC_API_URL=https://api.example.com
```

### এনভায়রনমেন্ট ভ্যারিয়েবল অ্যাক্সেস:
- **সার্ভার-সাইড কোডে**:
  ```jsx
  // app/api/data/route.js
  import { NextResponse } from "next/server";

  export async function GET() {
    const dbHost = process.env.DB_HOST; // সার্ভার-সাইড ভ্যারিয়েবল
    return NextResponse.json({ host: dbHost });
  }
  ```

- **ক্লায়েন্ট-সাইড কোডে**:
  ```jsx
  // app/components/ClientComponent.js
  "use client";
  import { useEffect } from "react";

  export default function ClientComponent() {
    useEffect(() => {
      console.log("API URL:", process.env.NEXT_PUBLIC_API_URL);
    }, []);
    return <div>ক্লায়েন্ট কম্পোনেন্ট</div>;
  }
  ```

### গুরুত্বপূর্ণ নিয়ম:
- **ক্লায়েন্ট-সাইড ভ্যারিয়েবল**: শুধুমাত্র `NEXT_PUBLIC_` প্রিফিক্স যুক্ত ভ্যারিয়েবল ক্লায়েন্ট-সাইডে অ্যাক্সেসযোগ্য। এগুলো ব্রাউজারে প্রকাশিত হয়, তাই সংবেদনশীল তথ্য এড়িয়ে চলুন।
- **সার্ভার-সাইড ভ্যারিয়েবল**: `NEXT_PUBLIC_` ছাড়া অন্য ভ্যারিয়েবল শুধুমাত্র সার্ভারে অ্যাক্সেসযোগ্য এবং নিরাপদ।
- **অটোমেটিক লোডিং**: Next.js স্বয়ংক্রিয়ভাবে `.env` ফাইল লোড করে, তবে কাস্টম সেটআপের জন্য `dotenv` প্যাকেজ ব্যবহার করা যেতে পারে।

---

## এনভায়রনমেন্ট ভ্যারিয়েবলসের বৈশিষ্ট্য

1. **সিকিউরিটি**:
   - সংবেদনশীল তথ্য (যেমন API কী, ডাটাবেস ক্রেডেনশিয়াল) কোডে হার্ডকোড না করে `.env` ফাইলে রাখা যায়।
   - `NEXT_PUBLIC_` ছাড়া ভ্যারিয়েবল ক্লায়েন্টে প্রকাশিত হয় না।

2. **পরিবেশ-নির্দিষ্ট কনফিগারেশন**:
   - ডেভেলপমেন্ট, টেস্টিং, এবং প্রোডাকশনের জন্য আলাদা `.env` ফাইল ব্যবহার করা যায়।
   - উদাহরণ: `.env.development` এবং `.env.production`।

3. **প্ল্যাটফর্ম ইন্টিগ্রেশন**:
   - Vercel, Netlify, বা অন্যান্য হোস্টিং প্ল্যাটফর্মে এনভায়রনমেন্ট ভ্যারিয়েবল সেট করা যায়।
   - উদাহরণ: Vercel-এর ড্যাশবোর্ডে ভ্যারিয়েবল যোগ করা।

4. **ক্রস-প্ল্যাটফর্ম সামঞ্জস্য**:
   - `.env` ফাইল স্ট্যান্ডার্ড ফরম্যাটে থাকে, যা Node.js এবং অন্যান্য ফ্রেমওয়ার্কের সাথে সামঞ্জস্যপূর্ণ।

---

## ব্যবহারের ক্ষেত্র

1. **API কী পরিচালনা**:
   - তৃতীয় পক্ষের API কী (যেমন Stripe, Google Maps) সংরক্ষণ।
   - উদাহরণ: `API_KEY=your-api-key`

2. **ডাটাবেস ক্রেডেনশিয়াল**:
   - ডাটাবেস হোস্ট, ইউজারনেম, এবং পাসওয়ার্ড সংরক্ষণ।
   - উদাহরণ: `DB_HOST=localhost`, `DB_USER=myuser`

3. **পরিবেশ-নির্দিষ্ট URL**:
   - ডেভেলপমেন্ট এবং প্রোডাকশনের জন্য ভিন্ন API URL।
   - উদাহরণ: `NEXT_PUBLIC_API_URL=https://api.example.com`

4. **অথেনটিকেশন সিক্রেট**:
   - JWT সিক্রেট বা OAuth ক্রেডেনশিয়াল সংরক্ষণ।
   - উদাহরণ: `JWT_SECRET=your-secret-key`

5. **ফিচার ফ্ল্যাগ**:
   - নির্দিষ্ট ফিচার চালু বা বন্ধ করার জন্য।
   - উদাহরণ: `NEXT_PUBLIC_FEATURE_X_ENABLED=true`

---

## সিনিয়র ডেভেলপারদের জন্য গুরুত্বপূর্ণ টিপস

1. **সিকিউরিটি**:
   - **ক্লায়েন্ট-সাইড ভ্যারিয়েবল এড়ানো**: সংবেদনশীল তথ্য (যেমন API কী) `NEXT_PUBLIC_` প্রিফিক্স ছাড়া রাখুন, কারণ এগুলো ক্লায়েন্টে প্রকাশিত হয়।
   - **.env ফাইল সুরক্ষা**: `.env` ফাইলগুলো `.gitignore`-এ যোগ করে সোর্স কন্ট্রোলে কমিট করা এড়ান।
     ```gitignore
     .env
     .env.local
     .env.*.local
     ```

2. **পরিবেশ-নির্দিষ্ট কনফিগারেশন**:
   - `.env.development` এবং `.env.production` ফাইল ব্যবহার করে পরিবেশ-নির্দিষ্ট মান সেট করুন।
   - Vercel বা Netlify-এর মতো প্ল্যাটফর্মে প্রোডাকশন ভ্যারিয়েবল সেট করুন।

3. **ডিফল্ট মান**:
   - ভ্যারিয়েবল উপলব্ধ না থাকলে ডিফল্ট মান ব্যবহার করুন।
   - উদাহরণ:

     ```jsx
     const apiUrl = process.env.NEXT_PUBLIC_API_URL || "https://default-api.com";
     ```

4. **ভ্যালিডেশন**:
   - এনভায়রনমেন্ট ভ্যারিয়েবল ভ্যালিডেট করতে `zod` বা `envalid` লাইব্রেরি ব্যবহার করুন।
   - উদাহরণ (zod ব্যবহার করে):

     ```jsx
     import { z } from "zod";

     const envSchema = z.object({
       DB_HOST: z.string().min(1),
       NEXT_PUBLIC_API_URL: z.string().url(),
     });

     const env = envSchema.parse(process.env);
     ```

5. **প্ল্যাটফর্ম ইন্টিগ্রেশন**:
   - Vercel-এর ড্যাশবোর্ডে এনভায়রনমেন্ট ভ্যারিয়েবল সেট করুন।
   - উদাহরণ: Vercel-এ `Add Environment Variable` অপশনে `DB_HOST` যোগ করা।

6. **ডকুমেন্টেশন**:
   - `.env.example` ফাইল তৈরি করে প্রয়োজনীয় ভ্যারিয়েবলের তালিকা এবং ডিফল্ট মান ডকুমেন্ট করুন।
   - উদাহরণ:

     ```env
     # .env.example
     DB_HOST=localhost
     DB_USER=
     DB_PASS=
     NEXT_PUBLIC_API_URL=https://api.example.com
     ```

7. **এনক্রিপশন**:
   - অতিরিক্ত সিকিউরিটির জন্য সংবেদনশীল ভ্যারিয়েবল এনক্রিপ্ট করে স্টোর করুন।
   - উদাহরণ: Vercel-এর `Encrypted Environment Variables` ব্যবহার।

---

## সুবিধা এবং চ্যালেঞ্জ

### সুবিধা:
- **সিকিউরিটি**: সংবেদনশীল তথ্য কোডে হার্ডকোড না করে নিরাপদে সংরক্ষণ।
- **নমনীয়তা**: বিভিন্ন পরিবেশের জন্য আলাদা কনফিগারেশন।
- **পোর্টাবিলিটি**: `.env` ফাইল স্ট্যান্ডার্ড ফরম্যাটে থাকায় যেকোনো প্ল্যাটফর্মে ব্যবহারযোগ্য।
- **ইন্টিগ্রেশন**: Vercel, Netlify, বা অন্যান্য হোস্টিং প্ল্যাটফর্মের সাথে সহজ ইন্টিগ্রেশন।

### চ্যালেঞ্জ:
- **ক্লায়েন্ট-সাইড এক্সপোজার**: `NEXT_PUBLIC_` ভ্যারিয়েবল ব্রাউজারে প্রকাশিত হয়, তাই সংবেদনশীল তথ্য এড়ানো জরুরি।
- **ম্যানেজমেন্ট**: একাধিক পরিবেশের জন্য ভ্যারিয়েবল ম্যানেজ করা জটিল হতে পারে।
- **ভ্যালিডেশন**: ভ্যারিয়েবলের সঠিকতা নিশ্চিত করতে অতিরিক্ত টুল প্রয়োজন।

---

## বাস্তব-বিশ্বে ব্যবহারের উদাহরণ

1. **API কী**:
   - তৃতীয় পক্ষের API কী সংরক্ষণ।
   - উদাহরণ: `STRIPE_API_KEY=sk_test_xxx`

2. **ডাটাবেস সংযোগ**:
   - MongoDB বা PostgreSQL ক্রেডেনশিয়াল।
   - উদাহরণ: `DB_URL=mongodb://localhost:27017/mydb`

3. **পরিবেশ-নির্দিষ্ট URL**:
   - ডেভেলপমেন্টে `http://localhost:3000` এবং প্রোডাকশনে `https://api.production.com`।
   - উদাহরণ: `NEXT_PUBLIC_API_URL=https://api.production.com`

4. **ফিচার ফ্ল্যাগ**:
   - নতুন ফিচার চালু বা বন্ধ করা।
   - উদাহরণ: `NEXT_PUBLIC_NEW_FEATURE_ENABLED=true`

5. **অথেনটিকেশন**:
   - JWT সিক্রেট বা OAuth ক্রেডেনশিয়াল।
   - উদাহরণ: `AUTH_SECRET=your-secret-key`

---

## উপসংহার

Next.js-এ এনভায়রনমেন্ট ভ্যারিয়েবলস সংবেদনশীল তথ্য এবং কনফিগারেশন পরিচালনার জন্য একটি অত্যন্ত গুরুত্বপূর্ণ ফিচার। এটি অ্যাপ্লিকেশনের সিকিউরিটি, নমনীয়তা, এবং পোর্টাবিলিটি বাড়ায়। সিনিয়র ডেভেলপার হিসেবে `.env` ফাইল সঠিকভাবে ম্যানেজ করা, সংবেদনশীল তথ্য সুরক্ষিত রাখা, এবং ভ্যালিডেশন প্রয়োগ করা গুরুত্বপূর্ণ। `NEXT_PUBLIC_` প্রিফিক্সের সঠিক ব্যবহার, ভ্যারিয়েবল ভ্যালিডেশন, এবং প্ল্যাটফর্ম ইন্টিগ্রেশনের মাধ্যমে আপনি একটি নিরাপদ, স্কেলেবল, এবং রক্ষণাবেক্ষণযোগ্য Next.js অ্যাপ তৈরি করতে পারেন।